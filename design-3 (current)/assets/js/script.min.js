///////////////////////////////////////////////////////////////////////////////////////////
// CONSTANTS //////////////////////////////////////////////////////////////////////////////

// Get elements from the DOM //////////////////////////////////////////////////////////////
const checkbox = document.getElementById("checkbox");
const s2_2 = document.getElementById("s2-2");
const linkedRoutes = document.querySelectorAll(".linked-route");
const expoUnits = document.querySelectorAll(".exp-unit");

// All Rights Reserved, Correct Year Specification ////////////////////////////////////////
const smallFontElements = document.querySelectorAll(".smallfont");
const currentYearSpan = document.getElementById('currentYear');
const currentYear = new Date().getFullYear();
currentYearSpan.textContent = currentYear;

// PopUpLinks /////////////////////////////////////////////////////////////////////////////
const popupLinks = document.getElementsByClassName("popupLink");
const popups = document.getElementsByClassName("popup");
const closeIcons = document.getElementsByClassName("close-icon");

// NavigationBar //////////////////////////////////////////////////////////////////////////
const setNavWidth = width => document.getElementById("navCloak").style.width = width;
const OpenNavbarFullWidth = () => setNavWidth("100%");
const closeNavbarFullWidth = () => setNavWidth("0%");

///////////////////////////////////////////////////////////////////////////////////////////
// Main Scripts ///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

// Function to add event listeners to linked routes
const addLinkedRouteListeners = (color) => {
    expoUnits.forEach(elementParent => {
        const linkedRoute = elementParent.querySelector(".linked-route");
        linkedRoute.style.color = color;

        elementParent.addEventListener("mouseover", () => {
            elementParent.style.cursor = "pointer";
            // linkedRoute.style.color = "#f1c40f";
        });
        elementParent.addEventListener("mouseout", () => {
            // linkedRoute.style.color = color;
        });
        elementParent.addEventListener("click", (event) => {
            event.preventDefault(); // Prevent the default link behavior
            const linkUrl = linkedRoute.getAttribute("href");
            if (linkUrl) {
                window.open(linkUrl, '_blank'); // Open link in new tab
            }
        });
    });
};

// Navbar Clicks //////////////////////////////////////////////////////////////////////////
document.getElementById("navigationBar").addEventListener("click", function () { OpenNavbarFullWidth(); });

document.addEventListener("click", function (event) {
    const scrollLinks = [
        document.getElementById("navCloak"),
        document.getElementById("scrollToWorkExperience"),
        document.getElementById("scrollToSideProjects"),
        document.getElementById("scrollToLinks"),
        document.getElementById("scrollToAbout"),
        document.getElementById("linked-icon-nav1"),
        document.getElementById("linked-icon-nav2"),
        document.getElementById("linked-icon-nav3"),
        document.getElementById("linked-icon-nav4")
    ];

    if (scrollLinks.includes(event.target) || scrollLinks.includes(event.target.parentElement)) { closeNavbarFullWidth(); }

    const CloakIDs = [
        document.getElementById("WE-UVR-Cloak"),
        document.getElementById("WE-DE-Cloak"),
        document.getElementById("SE-RuBiS-Cloak"),
        document.getElementById("SE-WeTR-Cloak"),
        document.getElementById("SE-TTT-Cloak"),
        document.getElementById("SE-TRe-Cloak")
    ];
    if (CloakIDs.includes(event.target) || CloakIDs.includes(event.target.parentElement) || CloakIDs.includes(event.target.parentElement.parentElement)) { CloakBarCL(); }
});


// Navbar Greyish Design //////////////////////////////////////////////////////////////////
window.addEventListener("scroll", function () {
    // closeNavbarFullWidth()
    const scrollingDiv = document.querySelector(".navrow");
    const scrollPosition = window.scrollY;
    const imageElement = scrollingDiv.querySelector('#arfazhxsse');
    const iconElement = scrollingDiv.querySelector('.material-icons');
    const startScroll = 0;
    const endScroll = 100;

    const progress = Math.min(1, (scrollPosition - startScroll) / (endScroll - startScroll));
    scrollingDiv.style.backgroundColor = `rgba(255, 255, 255, ${0.5 * progress})`;
    scrollingDiv.style.backdropFilter = `blur(${2 * progress}px)`;
    scrollingDiv.style.border = `${1 * progress}px solid rgb(235, 238, 241)`;
    imageElement.src = progress < 0.5 ? "assets/img/arfazhxsse-1" : "assets/img/arfazhxsse-2";
    iconElement.style.color = progress < 0.5 ? "#ffffff" : "#011E15";

});

// ScrollToSection ////////////////////////////////////////////////////////////////////////
function scrollToSection(sectionId) {
    const section = document.getElementById(sectionId);
    if (section) {
        const offset = section.offsetTop - 13 * window.innerHeight / 100; // Adjusted for 5cm down from the top
        window.scrollTo({
            top: offset,
            behavior: 'smooth'
        });
    }
}

// Function to attach click event listener to an element /////////////////////////////////
function addScrollListener(elementId, targetSectionId) {
    document.getElementById(elementId).addEventListener('click', function (event) {
        event.preventDefault();
        scrollToSection(targetSectionId);
    });
}

// Attach click event listeners to specific elements
addScrollListener('scrollToAbout', 'about');
addScrollListener('scrollToWorkExperience', 'workExperience');
addScrollListener('scrollToSideProjects', 'sideProjects');
addScrollListener('scrollToLinks', 'linksLower');

// Link Pop ///////////////////////////////////////////////////////////////////////////////
// function closeAllPopups() {
//   for (let i = 0; i < popups.length; i++) {
//     popups[i].style.display = "none";
//     popups[i].classList.remove("active");
//   }
// }

// for (let i = 0; i < popupLinks.length; i++) {
//   popupLinks[i].addEventListener("click", () => {
//     closeAllPopups();
//     popups[i].style.display = "block";
//     popups[i].classList.add("active");
//   });
// }

// for (let i = 0; i < closeIcons.length; i++) {
//   closeIcons[i].addEventListener("click", () => {
//     popups[i].style.display = "none";
//     popups[i].classList.remove("active");
//   });
// }

///////////////////////////////////////////////////////////////////////////////////////////

// LinkCloak ///////////////////////////////////////////////////////////////////////////////
document.getElementById("WE-UVR").addEventListener("click", function () { CloakBarOP('WE-UVR-Cloak'); });
document.getElementById("WE-DE").addEventListener("click", function () { CloakBarOP('WE-DE-Cloak'); });
document.getElementById("SE-RuBiS").addEventListener("click", function () { CloakBarOP('SE-RuBiS-Cloak'); });
document.getElementById("SE-WeTR").addEventListener("click", function () { CloakBarOP('SE-WeTR-Cloak'); });
document.getElementById("SE-TTT").addEventListener("click", function () { CloakBarOP('SE-TTT-Cloak'); });
document.getElementById("SE-TRe").addEventListener("click", function () { CloakBarOP('SE-TRe-Cloak'); });
function CloakBarOP(elementId) {
    CloakBarCL(elementId);
    const currentElement = document.getElementById(elementId);
    if (currentElement) { currentElement.style.width = "100%"; }
}

function CloakBarCL(excludeThisElementId) {
    const CloakLinks = [
        "WE-UVR-Cloak",
        "WE-DE-Cloak",
        "SE-RuBiS-Cloak",
        "SE-WeTR-Cloak",
        "SE-TTT-Cloak",
        "SE-TRe-Cloak"
    ];
    for (const elementID of CloakLinks) {
        const element = document.getElementById(elementID);
        if (excludeThisElementId === null || elementID !== excludeThisElementId) { element.style.width = "0%"; }
    }
}






///////////////////////////////////////////////////////////////////////////////////////////

